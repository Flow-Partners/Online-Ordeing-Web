<div class="checkout-container">
  <div class="checkout-wrapper">
    
    <!-- Left Section: Checkout Form -->
    <div class="checkout-form-section">
      
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="breadcrumb-nav">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a routerLink="/menu">Home</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">Checkout</li>
        </ol>
      </nav>

      <form [formGroup]="checkoutForm" (ngSubmit)="onPlaceOrder()">
        
        <!-- Personal Information -->
        <div class="form-section">
          <h3 class="section-title">Personal Information</h3>
          
          <div class="mb-3">
            <label for="fullName" class="form-label">Full Name</label>
            <input
              type="text"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('fullName')"
              id="fullName"
              formControlName="fullName"
              placeholder="Enter your name"
            />
            <div class="invalid-feedback" *ngIf="isFieldInvalid('fullName')">
              Full name is required
            </div>
          </div>

          <div class="mb-3">
            <label for="mobileNumber" class="form-label">Mobile Number</label>
            <div class="input-group">
              <span class="input-group-text country-code">
                <span class="flag">ðŸ‡µðŸ‡°</span>
                <span class="code">+92</span>
              </span>
              <input
                type="tel"
                class="form-control"
                [class.is-invalid]="isFieldInvalid('mobileNumber')"
                id="mobileNumber"
                formControlName="mobileNumber"
                placeholder="Enter your mobile number"
              />
              <div class="invalid-feedback" *ngIf="isFieldInvalid('mobileNumber')">
                Valid mobile number is required
              </div>
            </div>
          </div>

          <div class="mb-3">
            <label for="emailAddress" class="form-label">Email Address</label>
            <input
              type="email"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('emailAddress')"
              id="emailAddress"
              formControlName="emailAddress"
              placeholder="Enter your email address"
            />
            <div class="invalid-feedback" *ngIf="isFieldInvalid('emailAddress')">
              Valid email address is required
            </div>
          </div>
        </div>

        <!-- Address -->
        <div class="form-section">
          <h3 class="section-title">Your Address</h3>
          <button type="button" class="btn btn-dark address-btn">
            Add / Change Address
          </button>
          <div class="mt-3">
            <textarea
              class="form-control"
              [class.is-invalid]="isFieldInvalid('address')"
              formControlName="address"
              rows="3"
              placeholder="Enter your delivery address"
            ></textarea>
            <div class="invalid-feedback" *ngIf="isFieldInvalid('address')">
              Address is required
            </div>
          </div>
        </div>

        <!-- Special Instructions -->
        <div class="form-section">
          <h3 class="section-title">Special Instructions (Optional)</h3>
          <textarea
            class="form-control"
            formControlName="specialInstructions"
            rows="4"
            placeholder="Add any comment, e.g. about allergies, or delivery instructions here."
          ></textarea>
        </div>

        <!-- Payment Method -->
        <div class="form-section">
          <h3 class="section-title">Select Payment Method</h3>
          <div class="payment-methods">
            <button
              type="button"
              class="payment-method-btn"
              [class.active]="selectedPaymentMethod === 'cash'"
              (click)="selectPaymentMethod('cash')"
            >
              <i class="bi bi-check-circle-fill text-success"></i>
              <span>Cash On Delivery</span>
            </button>
            <button
              type="button"
              class="payment-method-btn"
              [class.active]="selectedPaymentMethod === 'card'"
              (click)="selectPaymentMethod('card')"
            >
              <i class="bi bi-credit-card text-muted"></i>
              <span>Credit/Debit Card, JazzCash, Easypaisa</span>
            </button>
          </div>
        </div>

      </form>
    </div>

    <!-- Right Section: Cart Summary -->
    <div class="cart-summary-section">
      <h3 class="cart-title">Your Cart</h3>
      
      <div class="cart-items">
        <div *ngFor="let item of cartItems" class="cart-item-card">
          <div class="cart-item-image">
            <img
              [src]="getImageUrl(item.menuItemImage)"
              [alt]="item.menuItemName"
              onerror="this.src='/assets/i18n/placeholder-food.png'"
            />
          </div>
          <div class="cart-item-details">
            <h5 class="cart-item-name">{{ item.menuItemName }}</h5>
            <p class="cart-item-desc">{{ item.portionName }} - {{ item.portionDetailName }}</p>
            <div class="cart-item-price">{{ formatPrice(item.price * item.quantity) }}</div>
            
            <div class="cart-item-actions">
              <div class="quantity-controls">
                <button
                  type="button"
                  class="btn btn-sm quantity-btn"
                  (click)="updateQuantity(item, -1)"
                  [disabled]="item.quantity <= 1"
                >
                  <i class="bi bi-dash"></i>
                </button>
                <span class="quantity">{{ item.quantity }}</span>
                <button
                  type="button"
                  class="btn btn-sm quantity-btn"
                  (click)="updateQuantity(item, 1)"
                >
                  <i class="bi bi-plus"></i>
                </button>
              </div>
              <button
                type="button"
                class="btn btn-link text-danger remove-btn"
                (click)="removeFromCart(item)"
                title="Remove"
              >
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Add More Items Link -->
      <div class="add-more-items">
        <a routerLink="/menu" class="add-more-link">
          <i class="bi bi-plus-circle"></i>
          <span>+ Add more items</span>
        </a>
      </div>

      <!-- Promo Code -->
      <div class="promo-section">
        <p class="promo-message">*To apply Promo Code, please login</p>
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            placeholder="Promo Code"
            disabled
          />
          <button class="btn btn-outline-secondary" type="button" disabled>Apply</button>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="order-summary">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>{{ formatPrice(getSubtotal()) }}</span>
        </div>
        <div class="summary-row">
          <span>Delivery Charges:</span>
          <span>{{ formatPrice(getDeliveryCharges()) }}</span>
        </div>
        <div class="summary-row total-row">
          <span><strong>Grand total:</strong></span>
          <span><strong>{{ formatPrice(getGrandTotal()) }}</strong></span>
        </div>
      </div>

      <!-- Place Order Button -->
      <button
        type="button"
        class="btn btn-dark w-100 place-order-btn"
        (click)="onPlaceOrder()"
        [disabled]="cartItems.length === 0"
      >
        Place Order
      </button>
    </div>

  </div>
</div>

